#pragma once
#include <cstdint>

#include "traccc/definitions/qualifiers.hpp"

// ------------------------------------------------------------
// ①  Weights stored in global memory for GPU execution;
//    on the host they act as regular constant arrays
// ------------------------------------------------------------

namespace traccc::fitting::detail {

// ------------------------------------------------------------
// ①  Weights stored in global memory for GPU execution;
//    on the host they act as regular constant arrays
// ------------------------------------------------------------
TRACCC_DEVICE TRACCC_ALIGN(4) inline const std::int8_t W0[1920] = {
    0, -3, 3, -5, 2, -2, 5, -6, 1, -2, 4, -4, 2, -1, 6, -6, 0, -3, 4, -4, 2, -1,
    5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4,
    3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3,
    3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 2, -1, 6, -6, 0, -3, 4, -4, 2, -1, 5, -5,
    1, -2, 4, -3, 3, 0,  6, -6, 0, -3, 3, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,
    6, -6, 1, -2, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5,
    2, -2, 5, -6, 1, -2, 4, -4, 2, -1, 6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2,
    4, -4, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6,
    1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1,
    5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3,
    3, 0,  6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 1, -2,
    4, -4, 2, -1, 6, -5, 2, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -2, 5, -6,
    1, -2, 4, -4, 2, -1, 6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,
    6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4,
    2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2,
    4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -3, 3, 0,  6, -6,
    0, -3, 3, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 1, -2, 4, -4, 2, -1,
    5, -5, 2, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -2, 5, -5, 1, -2, 4, -4,
    2, -1, 6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -3, 3, 0,  6, -6, 0, -3,
    3, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5,
    1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1,
    6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 4, -4,
    2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 1, -2, 4, -4, 2, -1, 6, -5, 2, -2,
    5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -2, 5, -6, 1, -2, 4, -4, 2, -1, 6, -6,
    0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1,
    5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3,
    3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 2, -1, 6, -6, 1, -3,
    4, -4, 2, -1, 5, -5, 1, -2, 4, -3, 3, 0,  6, -6, 0, -3, 3, -4, 2, -1, 5, -5,
    1, -2, 4, -4, 3, 0,  6, -6, 1, -2, 4, -4, 2, -1, 5, -5, 2, -2, 5, -3, 3, 0,
    6, -6, 0, -3, 3, -5, 2, -2, 5, -5, 1, -2, 4, -4, 2, -1, 6, -6, 0, -3, 4, -4,
    2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2,
    4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6,
    0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1,
    5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4,
    3, 0,  6, -6, 1, -2, 4, -4, 2, -1, 6, -5, 2, -2, 5, -3, 3, 0,  6, -6, 0, -3,
    3, -5, 2, -2, 5, -6, 1, -2, 4, -4, 2, -1, 6, -6, 0, -3, 4, -4, 2, -1, 5, -5,
    1, -2, 4, -4, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1,
    6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5,
    2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2,
    5, -3, 3, 0,  6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6,
    1, -2, 4, -4, 2, -1, 5, -5, 2, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -2,
    5, -5, 1, -2, 4, -4, 2, -1, 6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -3,
    3, 0,  6, -6, 0, -3, 3, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -2,
    4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5,
    1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,
    6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 1, -2, 4, -4,
    2, -1, 6, -5, 2, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -2, 5, -6, 1, -2,
    4, -4, 2, -1, 6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6,
    0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1,
    5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4,
    2, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -3, 3, 0,  6, -6, 0, -3,
    3, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 1, -2, 4, -4, 2, -1, 5, -5,
    1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -2, 5, -6, 1, -2, 4, -4, 2, -1,
    6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 0, -3, 3, -5,
    2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2,
    5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6,
    1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 4, -4, 2, -1,
    5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 1, -2, 4, -4, 2, -1, 6, -5, 2, -2, 5, -3,
    3, 0,  6, -6, 0, -3, 3, -5, 2, -2, 5, -6, 1, -2, 4, -4, 2, -1, 6, -6, 0, -3,
    4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5,
    1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,
    6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4,
    2, -1, 5, -5, 1, -2, 4, -3, 3, 0,  6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2,
    4, -4, 3, 0,  6, -6, 1, -2, 4, -4, 2, -1, 5, -5, 2, -2, 5, -3, 3, 0,  6, -6,
    0, -3, 3, -5, 2, -2, 5, -5, 1, -2, 4, -4, 2, -1, 6, -6, 0, -3, 4, -4, 2, -1,
    5, -5, 1, -2, 4, -3, 3, 0,  6, -6, 0, -3, 3, -4, 2, -1, 5, -5, 1, -2, 4, -4,
    3, -1, 6, -6, 1, -2, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3,
    3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5,
    1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,
    6, -6, 1, -2, 4, -4, 2, -1, 6, -5, 2, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5,
    2, -2, 5, -6, 1, -2, 4, -4, 2, -1, 6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2,
    4, -4, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6,
    1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1,
    5, -5, 1, -2, 4, -4, 2, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -3,
    3, 0,  6, -6, 0, -3, 3, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 1, -2,
    4, -4, 2, -1, 5, -5, 2, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -2, 5, -5,
    1, -2, 4, -4, 2, -1, 6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,
    6, -6, 0, -3, 3, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4,
    2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2,
    4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6,
    0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 1, -2, 4, -4, 2, -1,
    6, -5, 2, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -2, 5, -6, 1, -2, 4, -4,
    2, -1, 6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 0, -3,
    3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5,
    1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1,
    6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 4, -4,
    2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 1, -2, 4, -4, 2, -1, 6, -5, 2, -2,
    5, -3, 3, 0,  6, -6,
};

TRACCC_DEVICE TRACCC_ALIGN(4) inline const std::int8_t W1[512] = {
    1, -2, 4, -4, 2, -1, 6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -3, 3, 0,
    6, -6, 0, -3, 3, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -2, 4, -4,
    2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2,
    4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6,
    0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 1, -2, 4, -4, 2, -1,
    6, -5, 2, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -2, 5, -6, 1, -2, 4, -4,
    2, -1, 6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 0, -3,
    3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5,
    1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 2, -1,
    6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -3, 3, 0,  6, -6, 0, -3, 3, -4,
    2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 1, -2, 4, -4, 2, -1, 5, -5, 1, -2,
    5, -3, 3, 0,  6, -6, 0, -3, 3, -5, 2, -2, 5, -5, 1, -2, 4, -4, 2, -1, 6, -6,
    0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1,
    5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3,
    3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3,
    4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 4, -4, 2, -1, 5, -5,
    1, -2, 4, -4, 3, 0,  6, -6, 1, -2, 4, -4, 2, -1, 6, -5, 2, -2, 5, -3, 3, 0,
    6, -6, 0, -3, 3, -5, 2, -2, 5, -6, 1, -2, 4, -4, 2, -1, 6, -6, 0, -3, 4, -4,
    2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2,
    4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6,
    0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1,
    5, -5, 1, -2, 4, -3, 3, 0,  6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4,
    3, 0,  6, -6, 1, -2, 4, -4, 2, -1, 5, -5, 2, -2, 5, -3, 3, 0,  6, -6, 0, -3,
    3, -5, 2, -2, 5, -5,
};

TRACCC_DEVICE TRACCC_ALIGN(4) inline const std::int8_t W2[192] = {
    0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 2, -1, 6, -6, 1, -3, 4, -4, 2, -1,
    5, -5, 1, -2, 4, -3, 3, 0,  6, -6, 0, -3, 3, -4, 2, -1, 5, -5, 1, -2, 4, -4,
    3, 0,  6, -6, 1, -2, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3,
    3, -5, 2, -2, 5, -5, 1, -2, 4, -4, 2, -1, 6, -6, 0, -3, 4, -4, 2, -1, 5, -5,
    1, -2, 4, -4, 3, 0,  6, -6, 0, -3, 3, -5, 2, -1, 5, -5, 1, -2, 4, -4, 3, -1,
    6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2, 5, -3, 3, 0,  6, -6, 0, -3, 3, -5,
    2, -1, 5, -5, 1, -2, 4, -4, 3, -1, 6, -6, 1, -3, 4, -4, 2, -1, 5, -5, 1, -2,
    5, -3, 3, 0,  6, -6, 0, -3, 4, -4, 2, -1, 5, -5, 1, -2, 4, -4, 3, 0,  6, -6,
    1, -2, 4, -4, 2, -1, 6, -5, 2, -2, 5, -3, 3, 0,  6, -6,
};

}  // namespace traccc::fitting::detail

// ------------------------------------------------------------
// ②  提供與舊版 *完全相同* 的介面
// ------------------------------------------------------------

namespace traccc::fitting {
template <typename algebra_t, std::size_t D>
struct kalman_int8_gru_gain_predictor_weights {
    // 以 constexpr 參考的方式把外部陣列「掛」進來
    static constexpr const auto& W0 = detail::W0;
    static constexpr const auto& W1 = detail::W1;
    static constexpr const auto& W2 = detail::W2;
};
}  // namespace traccc::fitting
